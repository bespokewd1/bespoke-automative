---
import Layout from "./BaseLayout.astro";
import { HeroSection } from "@components/services/HeroSection";
import { ServiceFeatures } from "@components/services/ServiceFeatures";
import { BeforeAfterSlider } from "@components/services/BeforeAfterSlider";
import { RecentWorksGallery } from "@components/services/RecentWorksGallery";
import { OtherServices } from "@components/services/OtherServices";
import { VideoSection } from "@components/services/VideoSection";
import { RelatedArticles } from "@components/services/RelatedArticles";
import { SEOContent } from "@components/services/SEOContent";
import { ServiceAreas } from "@components/services/ServiceAreas";
import { FinalCTA } from "@components/services/FinalCTA";
import TelLink from "@components/TelLink";
import { Image } from "astro:assets";

import { DiagonalFillButton } from "@components/services/DiagonalFillButton";
import { stats, getOtherServices, type ServiceData } from "@data/services";

import engine from "@assets/images/services/engine.webp";
import engineRepair from "@assets/images/services/engine-repair.webp";
import breakSystem from "@assets/images/services/break-system.webp";
import breakLine from "@assets/images/services/break-line.webp";

import vanServicing from "@assets/images/services/van-servicing.webp";

interface Props {
  service: ServiceData;
}

const { service } = Astro.props;

const otherServices = getOtherServices(service.slug).map((s) => ({
  title: s.shortTitle,
  description: s.description,
  icon: s.icon,
  href: `/services/${s.slug}/`,
}));

// Sample articles data - replace with actual data
const relatedArticles = [
  {
    title: "Signs Your Car Battery Has to Be Replaced",
    excerpt:
      "Learn the warning signs that indicate your battery needs attention.",
    image: engineRepair.src,
    category: "Car Advice",
    date: "December 15, 2025",
    href: "/blog/battery-replacement-signs/",
  },
  {
    title: "How to Protect the Interior of Your Car",
    excerpt: "Tips for maintaining your vehicle's interior.",
    image: breakSystem.src,
    category: "Car Advice",
    date: "December 10, 2025",
    href: "/blog/protect-interior/",
  },
  {
    title: "Is Your Car's Check Engine Light Flashing?",
    excerpt: "What to do when your check engine light comes on.",
    image: engine.src,
    category: "Car Advice",
    date: "December 5, 2025",
    href: "/blog/check-engine-light/",
  },
  {
    title: "5 Must-Have Things in Your Car for Safety",
    excerpt: "Essential items every driver should keep in their vehicle.",
    image: breakLine.src,
    category: "Car Advice",
    date: "December 1, 2025",
    href: "/blog/car-safety-essentials/",
  },
];
---

<Layout title={service.metaTitle} description={service.metaDescription}>
  {/* Hero Section */}
  <HeroSection
    client:load
    headline={service.heroHeadline}
    subheadline={service.heroSubheadline}
    description={service.description}
    carImageUrl={service.heroImg.src}
    stats={stats}
  />

  {/* Services Included */}
  <section class="bg-bg">
    <div class="container mx-auto px-4">
      <ServiceFeatures client:visible features={service.features} />
    </div>
  </section>

  {/* SEO Content */}
  <section class="bg-bg pb-16">
    <div class="container mx-auto px-4">
      <SEOContent client:visible content={service.seoContent} />
    </div>
  </section>

  {/* Before/After Slider OR Recent Works Gallery */}
  {
    service.hasBeforeAfter ? (
      <section class="bg-bg-muted py-16">
        <div class="container mx-auto px-4">
          <h2 class="mb-8 text-3xl font-bold uppercase lg:text-4xl">
            Our Results
          </h2>
          {service.beforeAfterImgs.map((items) => (
            <BeforeAfterSlider
              client:visible
              beforeImage={items.beforeImg.src}
              afterImage={items.afterImg.src}
              beforeLabel="Before"
              afterLabel="After"
            />
          ))}
        </div>
      </section>
    ) : (
      <RecentWorksGallery client:visible items={service.recentWorks} />
    )
  }

  {/* Video Section */}
  <VideoSection
    client:visible
    title="Maintenance & Repairs"
    thumbnailUrl={engine.src}
    videoUrl="https://www.youtube.com/embed/VTDB3mKx7jM?si=rYH-xQ1IC_J8qBtt"
  />

  <ServiceAreas client:visible locations={service.locations} />

  {/* Other Services */}
  <OtherServices client:visible services={otherServices} />

  {/* Related Articles */}
  <RelatedArticles client:visible articles={relatedArticles} />

  {/* Final CTA */}
  <FinalCTA
    client:visible
    title="Ready to Get Started?"
    description={`Contact Bespoke Auto Repair today to schedule your ${service.shortTitle.toLowerCase()} service. We're here to keep you safely on the road.`}
  >
    {/* The Buttons */}
    <DiagonalFillButton client:visible href="/contact/">
      Book Service Online
    </DiagonalFillButton>

    <TelLink />
  </FinalCTA>
</Layout>
